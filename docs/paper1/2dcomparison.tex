\documentclass[twocolumn,showpacs,pre,preprintnumbers,floatfix]{revtex4-1}
\usepackage{graphicx}
\usepackage[english]{babel}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{amsmath}
\usepackage{color}
\usepackage{natbib}
\usepackage{tikz,pgfplots}
\usetikzlibrary{spy}

\newcommand{\todo}[1]{ \fbox{{\bf TODO:} \color{red} #1}}
\newcommand{\ff}{{\mathbf{f}}}
\newcommand{\nn}{{\mathbf{n}}}
\newcommand{\rr}{{\mathbf{r}}}
\newcommand{\ssigma}{{\boldsymbol{\sigma}}}
\newcommand{\uu}{{\mathbf{u}}}
\newcommand{\xx}{{\mathbf{x}}}
\newcommand{\yy}{{\mathbf{y}}}
\newcommand{\grad}{{\triangledown}}
\newcommand{\bigO}{{\mathcal{O}}}
\renewcommand{\SS}{{\mathcal{S}}}
\newcommand{\DD}{{\mathcal{D}}}

\newif\ifTikz
%\Tikztrue
\Tikzfalse
% use these to not build the tikz images.  They take a while for the
% compiler to build.  If not using tikz, then it will use
% includegraphics with the pdf copy of the tikz.  These files will need
% updated as the tikz pictures are updated.  See how to use
% tikzexternalize below

%\usepgfplotslibrary{external}
%\tikzexternalize
% for turning tikz into pdf uncomment and run pdflatex -shell-escape
% 2dcomparison.tex


\begin{document}

\title{A comparative study of numerical and experimental viscous flow
in porous media}

\author{Pietro de Anna}
\email[E-mail: ]{pietrodeanna@gmail.com}
\affiliation{Massachusetts Institute of Technology}
\author{Bryan Quaife}
\email[E-mail: ]{quaife@ices.utexas.edu}
\affiliation{University of Texas}
\author{George Biros}
\affiliation{University of Texas}
\author{Ruben Juanes}
\affiliation{Massachusetts Institute of Technology}

\begin{abstract}
abstract
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\em Introduction.}---We study things about porous flow.  Need to
discuss
\begin{itemize}
  \item Stokes assumption (small Reynold's number)
  \item 2D assumption
  \item Working with primitive variable instead of a homogenization such
  as Darcy's Law.
  \item Lagrangian coherent structures.
\end{itemize}
\begin{figure}[htps]
\ifTikz
\centering
  \input{circleGrains.tikz}
  \input{beanGrains.tikz}
\else
  \includegraphics{circleGrains.pdf}
  \includegraphics{beanGrains.pdf}
\fi
\caption{\label{f:beans} These geometry, which we call the {\em circle
geometry} and the {\em bean geometry}, consist of 465 exclusions and
has a porosity (the ratio of the region that contains the fluid) of
0.46 ({\em circle}) and 0. ({\em bean}).  The outer wall is denoted
by $\Gamma_{0}$, and the boundary of the inner exclusions by
$\Gamma_{k}$, $k=1,\ldots,465$.}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\em Experimental setup.}---Pietro discuses the
\begin{itemize}
  \item Experimental design
  \item Paramters and main variables
  \item Experimental methodologies
  \item PIV
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\em Numerical solution.}---Here we discuss our method for numerically
solving the Stokes equations
\begin{align}
  \mu \Delta \uu  = \grad p, \qquad \grad \cdot \uu = 0,
  \label{e:stokes}
\end{align}
with the no-slip boundary condition $\uu = \ff$.  We use a boundary
integral equation because it naturally handles complex geometries, does
not suffer from ill-conditioning associated with direct discretizations
of~\eqref{e:stokes}, achieves high-order accuracy by using appropriate
quadrature formulae, analytically satisfies the incompressibility
condition, and is solved in linear time by coupling an iterative solver
and the fast multipole method (FMM).  Given a domain $\Omega$ with
boundary $\Gamma$, and a target point $\xx \in \Omega \backslash
\Gamma$, the single- and double-layer potentials for the Stokes
equations are~\cite{poz1992}
\begin{align*}
  \SS[\ssigma](\xx) &= \frac{1}{4\pi\mu}\int_{\Gamma} \left(
  -\log\rho I + \frac{\rr \otimes\rr}{\rho^{2}} 
  \right)\ssigma(\yy)ds_{\yy},  \\
  \DD[\ssigma](\xx) &= \frac{1}{\pi}\int_{\Gamma} 
  \frac{\rr \cdot \nn}{\rho^{2}}\frac{\rr \otimes \rr}{\rho^{2}}
  \ssigma(\yy)ds_{\yy},
\end{align*}
where $\rr = \xx - \yy$, $\rho = \|\rr\|$, $\nn$ is the unit outward
normal of $\Gamma$, and $\ssigma$ is referred to as a density
function.  We represent $\uu$ as the combination of single- and
double-layer potentials
\begin{align}
  \uu(\xx) = \sum_{k=1}^{M} \SS[\ssigma_{k}](\xx) + 
    \DD[\ssigma_{0}](\xx).
  \label{e:integralRep}
\end{align}
The no-slip boundary condition is satisfied by solving for $\ssigma$ in
the integral equation defined only on $\Gamma$
\begin{align}
  \ff(\xx_{0}) = \uu(\xx_{0}) + \frac{1}{2}\left\{
    \begin{array}{cl}
      \ssigma(\xx_{0}) & \xx_{0} \in \Gamma_{0}, \\
      0 & \xx_{0} \in \Gamma \backslash \Gamma_{0}.
    \end{array}
    \right. 
    \label{e:integralEqn}
\end{align}
Solutions of~\eqref{e:integralEqn} are guaranteed to exist whenever the
no flux condition $\int_{\Gamma} \ff \cdot \nn=0$ is
satisfied~\cite{poz1992}.

We discretize~\eqref{e:integralEqn} with a Nystr\"{o}m method.  The
density function is discretized at a set of collocation points, and the
integrals are approximated with suitable quadrature rules.  $\SS$ is
discretized with a high-order Gauss-Trapezoid rule~\cite{alp1999}, and,
since the kernel of $\DD$ is smooth, the trapezoid rule, which
converges super-algebraically~\cite{tre:wei2014}, is used to discretize
$\DD$.  The resulting linear system is solved iteratively with
GMRES~\cite{saa:sch1986}, and the matrix-vector multiplication is
computed with $\bigO(N)$ operations by using the FMM~\cite{cmcl2012}.
We use a block-diagonal preconditioner, where each $\Gamma_{k}$,
$k=0,\ldots,M$, corresponds to a block.  For the circle boundaries, the
single-layer potential is known analytically and can be applied
efficiently with $\bigO(N \log N)$ operations with the Fast Fourier
Transform (FFT).  The single-layer potential for the bean boundaries is
precomputed and factorized as a dense matrix.  This dense operation is
manageable since we only require $N=256$ points each interior boundary
$\Gamma_{k}$, and $N=2048$ points for the exterior boundary.
Preconditioned GMRES with a tolerance of $10^{-6}$ solves this system
with 675 iterations for the circular geometry, and 1,703 iterations for
the bean geometry.

Once~\eqref{e:integralEqn} is solved, the velocity $\uu$ can be
computed at any point $\xx \in \Omega$ by applying the trapezoid rule
to the representation formula~\eqref{e:integralRep}.  However, the
quality of the quadrature rule degrades as $\xx$ approaches
$\Gamma$~\cite{bar2014,bar:wu:vee2014}.  We use a near-singular
integration strategy, first outlined in~\cite{bir:yin:zor2004}, that
guarantees a uniform quadrature error in all of $\Omega$ without
requiring a significant amount of additional computational work.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\em Results.}---We compare the flows in the two geometries.
Quantities of interest include (but are not limited to):
\begin{itemize}
  \item Point values of velocity field
  \item PDF of velocity in both directions
  \item Incompressibility
  \item Correlations of velocities
\end{itemize}

Now can use numerical solution to understand LCS


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{\em Conclusions.}---Experimental and numerical results are in decent
agreement.  Incompressibility is satisfied to an acceptable level.  3D
effects are not important




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\acknowledgements
This work was supported by DiaMonD.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{refs}

%\begin{thebibliography}{10}%
%\end{thebibliography}%
% copy everything from bbl file to here at the end


\end{document}
